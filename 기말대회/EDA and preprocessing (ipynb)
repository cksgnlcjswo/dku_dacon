{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "%reload_ext autoreload\n",
    "%autoreload 2\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "from matplotlib import pyplot as plt\n",
    "from matplotlib import rcParams\n",
    "import numpy as np\n",
    "from pathlib import Path\n",
    "import pandas as pd\n",
    "import re\n",
    "import seaborn as sns\n",
    "from nltk.stem.snowball import SnowballStemmer\n",
    "from tensorflow.keras.preprocessing.text import Tokenizer\n",
    "from tensorflow.keras.preprocessing.sequence import pad_sequences\n",
    "import warnings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "rcParams['figure.figsize'] = (16, 8)\n",
    "plt.style.use('fivethirtyeight')\n",
    "pd.set_option('max_columns', 100)\n",
    "pd.set_option(\"display.precision\", 4)\n",
    "warnings.simplefilter('ignore')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dir = Path('../input/')\n",
    "trn_file = data_dir / 'train.csv'\n",
    "tst_file = data_dir / 'test_x.csv'\n",
    "feature_dir = Path('../build/feature')\n",
    "feature_file = feature_dir / 'feature.csv'\n",
    "sub_dir = Path('../build/sub')\n",
    "sample_file = data_dir / 'sample_submission.csv'\n",
    "seed = 42"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(54879, 2)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>text</th>\n",
       "      <th>author</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>index</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>He was almost choking. There was so much, so m...</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>“Your sister asked for it, I suppose?”</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>She was engaged one day as she walked, in per...</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>The captain was in the porch, keeping himself ...</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>“Have mercy, gentlemen!” odin flung up his han...</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                    text  author\n",
       "index                                                           \n",
       "0      He was almost choking. There was so much, so m...       3\n",
       "1                 “Your sister asked for it, I suppose?”       2\n",
       "2       She was engaged one day as she walked, in per...       1\n",
       "3      The captain was in the porch, keeping himself ...       4\n",
       "4      “Have mercy, gentlemen!” odin flung up his han...       3"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "trn = pd.read_csv(trn_file, index_col=0)\n",
    "print(trn.shape)\n",
    "trn.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "text      object\n",
       "author     int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "trn.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAABCgAAAHyCAYAAAAp9f8SAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8vihELAAAACXBIWXMAAAsTAAALEwEAmpwYAAA2AElEQVR4nO39f5BX1Z0n/j/7iybb4o82bXcDkR+l6SAQo8YdQDdiAEdFN0MYMTqbSrJsGNSWGWUCKMlMHLNuEHEV4g9KRTMzWUlUghEnxtRadFZQpJNZXSxwkIwbRl2ElkmrEPAH9PePDO9PekBFbfrQ7eNR1VX2Pa/3fZ97zzn9xmfde99VbW1t7QEAAAAo6P9XugMAAAAAAgoAAACgOAEFAAAAUJyAAgAAAChOQAEAAAAUJ6AAAAAAihNQAAAAAMUJKAAAAIDiBBQHmPXr15fuAp3AOPYMxrFnMI49g3HsGYxjz2Acuz9j2DP0xHEUUAAAAADFCSgAAACA4gQUAAAAQHECCgAAAKA4AQUAAABQnIACAAAAKE5AAQAAABQnoAAAAACKE1AAAAAAxQkoAAAAgOIEFAAAAEBxAgoAAACgOAEFAAAAUJyAAgAAAChOQAEAAAAUJ6AAAAAAihNQAAAAAMUJKAAAAIDiBBQAAABAcQeV7gAAAHwY1XzvxdJdeJ8OSVZ0r763Tfp46S4A+8AVFAAAAEBxAgoAAACgOAEFAAAAUJyAAgAAAChOQAEAAAAUJ6AAAAAAihNQAAAAAMUJKAAAAIDiBBQAAABAcQIKAAAAoDgBBQAAAFCcgAIAAAAoTkABAAAAFCegAAAAAIoTUAAAAADFCSgAAACA4gQUAAAAQHECCgAAAKA4AQUAAABQnIACAAAAKE5AAQAAABQnoAAAAACKE1AAAAAAxQkoAAAAgOIEFAAAAEBxAgoAAACguH0KKB577LFceOGFGTJkSGpqanL33Xe/be3ll1+empqa3HTTTR22v/7665kxY0aOOeaY9OvXLxdeeGFefPHFDjXPP/98LrjggvTr1y/HHHNMZs6cmTfeeKNDzYoVK3L66aenoaEhJ5xwQu666659PVYAAADgALVPAcW2bdsydOjQXHvttamurn7bugceeCD/8A//kL59++7RNmvWrDz44IO5884789BDD+W1117LBRdckJ07dyZJdu7cmQsuuCBbt27NQw89lDvvvDNLly7NN7/5zco+fv3rX+eLX/xihg8fnkcffTR/8Rd/kZkzZ+aBBx54r8cNAAAAHEAO2peiM888M2eeeWaSpKmpaa81//zP/5wrr7wyP/7xjzNx4sQOba+88kq+//3v55Zbbsno0aOTJLfddluOP/74/PznP8/YsWOzbNmyPPPMM3n66adz9NFHJ0muvvrq/Pmf/3n+6q/+Kocffni+973vpU+fPpk7d26SZPDgwfnlL3+Zm2++OePHj39/ZwAAAAAorlOeQfHWW29l8uTJmT59egYPHrxH+1NPPZU333wzY8aMqWw7+uijM3jw4KxatSpJ0tLSksGDB1fCiSQZO3ZsXn/99Tz11FOVmt/fx+6aJ598Mm+++WZnHAoAAABQwD5dQfFuZs+enY997GP52te+ttf2zZs3p1evXqmtre2wva6uLps3b67U1NXVdWivra1Nr169OtR87nOf22Mfb731VrZs2ZI+ffrs9f3Xr1//fg6rmO7WX/bOOPYMxrFnMI49g3HsGYzj7zukdAc+NMy7PTknPUN3G8fGxsZ3bP/AAcXy5cuzaNGiLF++/IPuar95t5NwIFm/fn236i97Zxx7BuPYMxjHnsE49gzG8d9Y8eK719ApzLuOrMWeoSeO4we+xWPFihV56aWXMnjw4NTW1qa2tjbPP/98rrrqqgwdOjRJUl9fn507d2bLli0dXtva2pr6+vpKTWtra4f2LVu2ZOfOne9Y09ramoMOOmiPqzMAAACA7uMDBxSTJ0/OY489luXLl1d++vbtm6ampsq3a5x44ok5+OCD09zcXHndiy++mHXr1mXEiBFJkuHDh2fdunUdvnq0ubk5H/3oR3PiiSdWan5/H7trTjrppBx88MEf9FAAAACAQvbpFo+tW7fmueeeS5Ls2rUrL7zwQlavXp0jjzwy/fv33+PZEQcddFAaGhoql5scccQR+fKXv5yrrroqdXV1OfLII/PNb34zw4YNqzxTYsyYMRkyZEguvvjiXHPNNfnNb36Tb33rW/nKV76Sww8/PEkyadKk3HHHHbnyyiszadKkrFq1KosWLcrChQs763wAAAAABezTFRRPPvlkRo0alVGjRmX79u2ZPXt2Ro0ale985zv7/EazZ8/Oueeem0mTJuXss89O796988Mf/jC9evVKkvTq1Sv33HNPDjnkkJx99tmZNGlSPv/5z+eaa66p7GPQoEG599578/jjj+e0007L9ddfnzlz5viKUQAAAOjm9ukKitNOOy1tbW37vNOnn356j20f/ehHM3fu3MydO/dtX9e/f//cc88977jvz372s3n00Uf3uS8AAADAge8DP4MCAAAA4IMSUAAAAADFCSgAAACA4gQUAAAAQHECCgAAAKA4AQUAAABQnIACAAAAKE5AAQAAABQnoAAAAACKE1AAAAAAxQkoAAAAgOIEFAAAAEBxAgoAAACgOAEFAAAAUJyAAgAAAChOQAEAAAAUd1DpDtDRH6w4JFnxYulufCi0Tfp46S4AAADwr1xBAQAAABQnoAAAAACKE1AAAAAAxQkoAAAAgOIEFAAAAEBxAgoAAACgOAEFAAAAUJyAAgAAAChOQAEAAAAUJ6AAAAAAihNQAAAAAMUJKAAAAIDiBBQAAABAcQIKAAAAoDgBBQAAAFCcgAIAAAAoTkABAAAAFCegAAAAAIoTUAAAAADFCSgAAACA4gQUAAAAQHECCgAAAKA4AQUAAABQnIACAAAAKE5AAQAAABQnoAAAAACKE1AAAAAAxQkoAAAAgOIEFAAAAEBxAgoAAACgOAEFAAAAUNw+BRSPPfZYLrzwwgwZMiQ1NTW5++67K21vvvlmrrrqqpx66qnp169fBg8enMmTJ+f555/vsI/XX389M2bMyDHHHJN+/frlwgsvzIsvvtih5vnnn88FF1yQfv365ZhjjsnMmTPzxhtvdKhZsWJFTj/99DQ0NOSEE07IXXfd9X6PHQAAADhA7FNAsW3btgwdOjTXXnttqqurO7T99re/zf/5P/8n06dPz//6X/8rixYtyosvvpiJEyfmrbfeqtTNmjUrDz74YO6888489NBDee2113LBBRdk586dSZKdO3fmggsuyNatW/PQQw/lzjvvzNKlS/PNb36zso9f//rX+eIXv5jhw4fn0UcfzV/8xV9k5syZeeCBBzrjXAAAAACFHLQvRWeeeWbOPPPMJElTU1OHtiOOOCI//vGPO2y78cYbM3LkyKxbty7Dhg3LK6+8ku9///u55ZZbMnr06CTJbbfdluOPPz4///nPM3bs2CxbtizPPPNMnn766Rx99NFJkquvvjp//ud/nr/6q7/K4Ycfnu9973vp06dP5s6dmyQZPHhwfvnLX+bmm2/O+PHjP9CJAAAAAMrZL8+geO2115IkNTU1SZKnnnoqb775ZsaMGVOpOfroozN48OCsWrUqSdLS0pLBgwdXwokkGTt2bF5//fU89dRTlZrf38fumieffDJvvvnm/jgUAAAAoAvs0xUU78Ubb7yRv/zLv8zZZ5+dj3/840mSzZs3p1evXqmtre1QW1dXl82bN1dq6urqOrTX1tamV69eHWo+97nP7bGPt956K1u2bEmfPn322qf169d3xqF1kUNKd+BDY3/Pi+4173g7xrFnMI49g3HsGYzj7/Pvvq5i3u3JOekZuts4NjY2vmN7pwYUb731VqZMmZJXXnklP/jBDzpz1x/Iu52EA8qKF9+9hk6xP+fF+vXru9e8Y6+MY89gHHsG49gzGMd/w7/7uox515G12DP0xHHstFs83nrrrXzta1/LmjVr8sADD+RjH/tYpa2+vj47d+7Mli1bOrymtbU19fX1lZrW1tYO7Vu2bMnOnTvfsaa1tTUHHXTQHldnAAAAAN1HpwQUb775ZiZNmpQ1a9bkwQcfTENDQ4f2E088MQcffHCam5sr21588cWsW7cuI0aMSJIMHz4869at6/DVo83NzfnoRz+aE088sVLz+/vYXXPSSSfl4IMP7oxDAQAAAArYp1s8tm7dmueeey5JsmvXrrzwwgtZvXp1jjzyyPTt2zdf/epX8+STT+YHP/hBqqqqsmnTpiTJ4Ycfnurq6hxxxBH58pe/nKuuuip1dXU58sgj881vfjPDhg2rPFNizJgxGTJkSC6++OJcc801+c1vfpNvfetb+cpXvpLDDz88STJp0qTccccdufLKKzNp0qSsWrUqixYtysKFC/fDqQEAAAC6yj5dQfHkk09m1KhRGTVqVLZv357Zs2dn1KhR+c53vpMXX3wxDz30UDZu3JjPfe5zGTx4cOVnyZIllX3Mnj075557biZNmpSzzz47vXv3zg9/+MP06tUrSdKrV6/cc889OeSQQ3L22Wdn0qRJ+fznP59rrrmmso9Bgwbl3nvvzeOPP57TTjst119/febMmeMrRgEAAKCb26crKE477bS0tbW9bfs7te320Y9+NHPnzs3cuXPftqZ///6555573nE/n/3sZ/Poo4++6/sBAAAA3UenPSQTAAAA4P0SUAAAAADFCSgAAACA4gQUAAAAQHECCgAAAKA4AQUAAABQ3D59zSgAQEl/sOKQZMWLpbvxodA26eOluwDAh5QrKAAAAIDiBBQAAABAcQIKAAAAoDgBBQAAAFCcgAIAAAAoTkABAAAAFCegAAAAAIoTUAAAAADFCSgAAACA4gQUAAAAQHECCgAAAKA4AQUAAABQnIACAAAAKE5AAQAAABQnoAAAAACKE1AAAAAAxQkoAAAAgOIEFAAAAEBxAgoAAACgOAEFAAAAUJyAAgAAAChOQAEAAAAUJ6AAAAAAihNQAAAAAMUJKAAAAIDiBBQAAABAcQIKAAAAoDgBBQAAAFCcgAIAAAAoTkABAAAAFCegAAAAAIoTUAAAAADFCSgAAACA4gQUAAAAQHECCgAAAKA4AQUAAABQnIACAAAAKE5AAQAAABQnoAAAAACKE1AAAAAAxQkoAAAAgOL2KaB47LHHcuGFF2bIkCGpqanJ3Xff3aG9vb09s2fPznHHHZc+ffrk3HPPzTPPPNOhpq2tLVOmTMmAAQMyYMCATJkyJW1tbR1q1qxZk3POOSd9+vTJkCFDMmfOnLS3t3eoeeCBBzJixIjU19dnxIgRefDBB9/HYQMAAAAHkn0KKLZt25ahQ4fm2muvTXV19R7t8+fPzy233JI5c+Zk2bJlqaury4QJE/Laa69VaiZPnpzVq1dn8eLFWbx4cVavXp2LLrqo0v7qq69mwoQJqa+vz7Jly3Lttdfmpptuys0331ypaWlpyX/5L/8l559/fpYvX57zzz8///k//+f88pe//CDnAAAAACjsoH0pOvPMM3PmmWcmSZqamjq0tbe3Z8GCBbn88sszfvz4JMmCBQvS2NiYxYsXZ9KkSVm3bl0eeeSRPPzwwxk+fHiS5MYbb8y4ceOyfv36NDY25r777sv27duzYMGCVFdXZ+jQoXn22Wdz6623ZurUqamqqsqCBQty2mmnZfr06UmSwYMHZ/ny5VmwYEHuvPPOTjspAAAAQNf6wM+g2LBhQzZt2pQxY8ZUtlVXV+fUU0/NqlWrkvzuyodDDz00I0aMqNSMHDkyvXv37lBzyimndLhCY+zYsdm4cWM2bNiQJPnFL37R4X121+zeBwAAANA97dMVFO9k06ZNSZK6uroO2+vq6rJx48YkyebNm1NbW5uqqqpKe1VVVY466qhs3ry5UtOvX7899rG7bdCgQdm0adNe32f3Pt7O+vXr38eRlXJI6Q58aOzvedG95h1vxzj2DMaxJ/D52FV8PnYl87qrmHd7ck56hu42jo2Nje/Y/oEDiu7g3U7CAWXFi6V78KGxP+fF7luX6N6MY89gHHsIn49dxudjFzKvu4x515G12DP0xHH8wLd4NDQ0JElaW1s7bG9tbU19fX2SpL6+Plu2bOnwjRzt7e15+eWXO9TsbR+723a/1zu9DwAAANA9feCAYuDAgWloaEhzc3Nl244dO7Jy5crKMyeGDx+erVu3pqWlpVLT0tKSbdu2dahZuXJlduzYUalpbm5O3759M3DgwCTJH/zBH3R4n901v/9sCwAAAKD72aeAYuvWrVm9enVWr16dXbt25YUXXsjq1avz/PPPp6qqKpdccknmz5+fpUuXZu3atWlqakrv3r0zceLEJL/7to0zzjgj06ZNS0tLS1paWjJt2rScddZZlUtSJk6cmOrq6jQ1NWXt2rVZunRp5s2bl6ampsqzKy6++OI8+uijufHGG/Pss8/mhhtuyPLly3PJJZfsp9MDAAAAdIV9CiiefPLJjBo1KqNGjcr27dsze/bsjBo1Kt/5zneSJJdddlkuueSSzJgxI6NHj85LL72UJUuW5LDDDqvsY+HChfnUpz6V8847L+edd14+9alP5bbbbqu0H3HEEbn//vuzcePGjB49OjNmzMill16aqVOnVmpGjBiRu+66K4sWLcp/+A//IT/84Q9z11135d//+3/fWecDAAAAKGCfHpJ52mmnpa2t7W3bq6qqMmvWrMyaNetta2pqanL77be/4/sMGzYsP/3pT9+xZvz48Rk/fvw71gAAAADdywd+BgUAAADAByWgAAAAAIoTUAAAAADFCSgAAACA4gQUAAAAQHECCgAAAKA4AQUAAABQnIACAAAAKE5AAQAAABQnoAAAAACKE1AAAAAAxQkoAAAAgOIEFAAAAEBxAgoAAACgOAEFAAAAUJyAAgAAAChOQAEAAAAUJ6AAAAAAihNQAAAAAMUJKAAAAIDiBBQAAABAcQIKAAAAoDgBBQAAAFCcgAIAAAAoTkABAAAAFCegAAAAAIoTUAAAAADFCSgAAACA4gQUAAAAQHECCgAAAKA4AQUAAABQnIACAAAAKE5AAQAAABQnoAAAAACKE1AAAAAAxQkoAAAAgOIEFAAAAEBxAgoAAACgOAEFAAAAUJyAAgAAAChOQAEAAAAUJ6AAAAAAihNQAAAAAMUJKAAAAIDiBBQAAABAcQIKAAAAoDgBBQAAAFCcgAIAAAAorlMCip07d+aaa67Jpz/96TQ0NOTTn/50rrnmmrz11luVmvb29syePTvHHXdc+vTpk3PPPTfPPPNMh/20tbVlypQpGTBgQAYMGJApU6akra2tQ82aNWtyzjnnpE+fPhkyZEjmzJmT9vb2zjgMAAAAoJBOCSjmzZuXhQsXZs6cOWlpacm1116bO+64IzfccEOlZv78+bnlllsyZ86cLFu2LHV1dZkwYUJee+21Ss3kyZOzevXqLF68OIsXL87q1atz0UUXVdpfffXVTJgwIfX19Vm2bFmuvfba3HTTTbn55ps74zAAAACAQg7qjJ20tLTk7LPPzrhx45IkAwcOzLhx4/IP//APSX539cSCBQty+eWXZ/z48UmSBQsWpLGxMYsXL86kSZOybt26PPLII3n44YczfPjwJMmNN96YcePGZf369WlsbMx9992X7du3Z8GCBamurs7QoUPz7LPP5tZbb83UqVNTVVXVGYcDAAAAdLFOuYJi5MiRWbFiRZ599tkkyT/+4z9m+fLl+cM//MMkyYYNG7Jp06aMGTOm8prq6uqceuqpWbVqVZLfhRyHHnpoRowY0WG/vXv37lBzyimnpLq6ulIzduzYbNy4MRs2bOiMQwEAAAAK6JQrKC6//PJs3bo1I0aMSK9evfLWW29l+vTpmTx5cpJk06ZNSZK6uroOr6urq8vGjRuTJJs3b05tbW2HqyCqqqpy1FFHZfPmzZWafv367bGP3W2DBg3aa//Wr1//wQ+yyxxSugMfGvt7XnSvecfbMY49g3HsCXw+dhWfj13JvO4q5t2enJOeobuNY2Nj4zu2d0pAsWTJkvzwhz/MwoULc9xxx+Xpp5/OlVdemQEDBuQrX/lKZ7zFB/JuJ+GAsuLF0j340Nif82L3bUl0b8axZzCOPYTPxy7j87ELmdddxrzryFrsGXriOHZKQPGtb30rU6dOzXnnnZckGTZsWJ5//vnceOON+cpXvpKGhoYkSWtra/r37195XWtra+rr65Mk9fX12bJlS9rb2ytXUbS3t+fll1/uUNPa2trhvXf/vrsGAAAA6H465RkUv/3tb9OrV68O23r16pVdu3Yl+d1DMxsaGtLc3Fxp37FjR1auXFl55sTw4cOzdevWtLS0VGpaWlqybdu2DjUrV67Mjh07KjXNzc3p27dvBg4c2BmHAgAAABTQKQHF2WefnXnz5uVnP/tZNmzYkAcffDC33HJL/uN//I9JfvcsiUsuuSTz58/P0qVLs3bt2jQ1NaV3796ZOHFikmTw4ME544wzMm3atLS0tKSlpSXTpk3LWWedVblsZeLEiamurk5TU1PWrl2bpUuXZt68eWlqavINHgAAANCNdcotHtddd13+23/7b/n617+el19+OQ0NDfnqV7+amTNnVmouu+yybN++PTNmzEhbW1tOPvnkLFmyJIcddlilZuHChZk5c2blVpFx48bluuuuq7QfccQRuf/++zN9+vSMHj06NTU1ufTSSzN16tTOOAwAAACgkKq2trb20p3g/1PzPQ9L6iptkz6+3/bdEx9Y82FkHHsG49gz+HzsOj4fu4553XX257zujvbnWjSvu84vPvvbHvc3tVNu8QAAAAD4IAQUAAAAQHECCgAAAKA4AQUAAABQnIACAAAAKE5AAQAAABQnoAAAAACKE1AAAAAAxQkoAAAAgOIEFAAAAEBxAgoAAACgOAEFAAAAUJyAAgAAAChOQAEAAAAUJ6AAAAAAihNQAAAAAMUdVLoDQM9X870XS3fhfTokWdH9+t426eOluwAAAO+ZKygAAACA4gQUAAAAQHECCgAAAKA4AQUAAABQnIACAAAAKE5AAQAAABQnoAAAAACKE1AAAAAAxQkoAAAAgOIEFAAAAEBxAgoAAACgOAEFAAAAUJyAAgAAAChOQAEAAAAUJ6AAAAAAihNQAAAAAMUJKAAAAIDiBBQAAABAcQIKAAAAoDgBBQAAAFCcgAIAAAAoTkABAAAAFCegAAAAAIoTUAAAAADFCSgAAACA4gQUAAAAQHECCgAAAKA4AQUAAABQnIACAAAAKE5AAQAAABQnoAAAAACK67SA4qWXXsrFF1+cY489Ng0NDRkxYkRWrFhRaW9vb8/s2bNz3HHHpU+fPjn33HPzzDPPdNhHW1tbpkyZkgEDBmTAgAGZMmVK2traOtSsWbMm55xzTvr06ZMhQ4Zkzpw5aW9v76zDAAAAAArolICira0tZ511Vtrb23Pvvfdm1apVue6661JXV1epmT9/fm655ZbMmTMny5YtS11dXSZMmJDXXnutUjN58uSsXr06ixcvzuLFi7N69epcdNFFlfZXX301EyZMSH19fZYtW5Zrr702N910U26++ebOOAwAAACgkIM6Yyff/e5306dPn9x2222VbYMGDar8d3t7exYsWJDLL78848ePT5IsWLAgjY2NWbx4cSZNmpR169blkUceycMPP5zhw4cnSW688caMGzcu69evT2NjY+67775s3749CxYsSHV1dYYOHZpnn302t956a6ZOnZqqqqrOOBwAAACgi3XKFRQ/+clPcvLJJ2fSpEn5xCc+kc9+9rO5/fbbK7debNiwIZs2bcqYMWMqr6murs6pp56aVatWJUlaWlpy6KGHZsSIEZWakSNHpnfv3h1qTjnllFRXV1dqxo4dm40bN2bDhg2dcSgAAABAAZ1yBcWvf/3r3HnnnWlqasrll1+ep59+OldccUWSZMqUKdm0aVOSdLjlY/fvGzduTJJs3rw5tbW1Ha6CqKqqylFHHZXNmzdXavr167fHPna3/f5VG79v/fr1H/wgu8whpTvwobG/50X3mnf7m3ndlcy9PTknPYG/I13F52NXMq+7inm3p/13TszrrtTd5nZjY+M7tndKQLFr166cdNJJueqqq5IkJ5xwQp577rksXLgwU6ZM6Yy3+EDe7SQcUFa8WLoHHxr7c17svi2Jf2VedylzryPrsYfwd6TL+HzsQuZ1lzHvOtqva9G87lI9bW53yi0eDQ0NGTx4cIdtn/zkJ/PCCy9U2pOktbW1Q01ra2vq6+uTJPX19dmyZUuHb+Rob2/Pyy+/3KFmb/vY3QYAAAB0T50SUIwcOTK/+tWvOmz71a9+lf79+ydJBg4cmIaGhjQ3N1fad+zYkZUrV1aeOTF8+PBs3bo1LS0tlZqWlpZs27atQ83KlSuzY8eOSk1zc3P69u2bgQMHdsahAAAAAAV0SkDR1NSUX/ziF7n++uvz3HPP5cc//nFuv/32TJ48OcnvniVxySWXZP78+Vm6dGnWrl2bpqam9O7dOxMnTkySDB48OGeccUamTZuWlpaWtLS0ZNq0aTnrrLMql61MnDgx1dXVaWpqytq1a7N06dLMmzcvTU1NvsEDAAAAurFOeQbFZz7zmdx999359re/nblz5+boo4/ON77xjUpAkSSXXXZZtm/fnhkzZqStrS0nn3xylixZksMOO6xSs3DhwsycOTPnnXdekmTcuHG57rrrKu1HHHFE7r///kyfPj2jR49OTU1NLr300kydOrUzDgMAAAAopFMCiiQ5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59lnn+3CHvNvPfbYY7nwwgszZMiQ1NTU5O67737X16xZsybnnHNO+vTpkyFDhmTOnDlpb+82X4TU47zXMdywYcNe1+IjjzzSRT1mb2644YaMHj06/fv3z7HHHpsLLrgga9eufdfXWY8HlvczjtbkgeeOO+7Iqaeemv79+6d///75wz/8w/zsZz97x9dYiweW9zqG1mH3cMMNN6SmpiYzZsx4x7qesB673RUUSTJ58uRMnjy5dDfesyVLluTKK6/Mf//v/z0jR47MwoULc/755+eJJ55I//7996j/9a9/nS9+8Yv50pe+lNtvvz1PPPFEvv71r6e2tjbjx48vcAQk730cd3viiSdy5JFHVn4/6qijuqK7vI1t27Zl6NCh+ZM/+ZNcfPHF71r/6quvZsKECTn11FOzbNmyrF+/PpdeemkOOeSQ/Nmf/VkX9Jh/672O4W4/+tGP8qlPfary+++vS7reihUr8rWvfS2f+cxn0t7enu985zv5whe+kFWrVr3t2FiPB573M467WZMHjn79+uXqq6/Osccem127duUHP/hBvvSlL+XnP/95hzHazVo88LzXMdzNOjxw/eIXv8jf/M3fZNiwYe9Y11PWY1VbW1v3ilS6sbFjx2bYsGH57ne/W9n2mc98JuPHj89VV121R/1VV12VBx98MP/7f//vyrY/+7M/yz/+4z/mf/7P/9klfWZP73Ucly9fns9//vP5p3/6p9TW1nZlV9lHH//4x3PdddflS1/60tvW3Hnnnfnrv/7rPPvss6murk6SzJ07N3fddVfWrl2bqqqqruoue7EvY7hhw4accMIJaW5uzkknndSFveO92Lp1awYMGJC7774748aN22uN9Xjg25dxtCa7h0GDBuWqq67a6+3U1mL38E5jaB0e2F555ZWcfvrp+e53v5s5c+Zk6NChmTt37l5re8p67Ha3eHRXb7zxRp566qmMGTOmw/YxY8Zk1apVe31NS0vLHvVjx47Nk08+mTfffHO/9ZW3937GcbfPfe5zGTx4cP7oj/4ojz766P7sJvtBS0tLTjnllMof/OR363Hjxo3ZsGFDwZ7xXn35y1/OJz7xiZx11ll54IEHSneHf2Pr1q3ZtWtXampq3rbGejzw7cs47mZNHph27tyZH/3oR9m2bVuGDx++1xpr8cC2L2O4m3V4YLr88sszfvz4jBo16l1re8p6FFB0kS1btmTnzp2pq6vrsL2uri6bN2/e62s2b9681/q33norW7Zs2W995e29n3Hs06dPbrjhhnz/+9/P97///TQ2Nmb8+PHv+vwRDixvtx53t3HgO/TQQ/Nf/+t/zfe+973cd999GTVqVCZNmpR77rmndNf4PVdeeWWOP/74d/zHtPV44NuXcbQmD0xr1qzJxz/+8dTX12fatGn5H//jf7ztpeXW4oHpvYyhdXjg+tu//ds899xz+cu//Mt9qu8p67FbPoMCupPGxsY0NjZWfh8+fHj++Z//Od/97ndz6qmnFuwZfLjU1tZ2uAfzpJNOyr/8y79k/vz5ueCCCwr2jN2+8Y1v5IknnsjDDz+cXr16le4O79O+jqM1eWBqbGzM8uXL8+qrr+aBBx7IJZdckr//+7/P0KFDS3eNffRextA6PDCtX78+3/72t/Pwww/n4IMPLt2dLuUKii5SW1ubXr16pbW1tcP21tbW1NfX7/U19fX1e60/6KCDPMugkPczjntz8skn57nnnuvs7rEfvd163N1G92QtHjhmzZqVH/3oR1m6dGkGDRr0jrXW44HrvYzj3liT5X3kIx/JMccckxNPPDFXXXVVjj/++Nx66617rbUWD0zvZQz3xjosr6WlJVu2bMnIkSNTW1ub2traPPbYY1m4cGFqa2vz+uuv7/GanrIeBRRd5CMf+UhOPPHENDc3d9je3NycESNG7PU1w4cP32v9SSed9KFL0g4U72cc9+bpp59OQ0NDZ3eP/Wj48OFZuXJlduzYUdnW3Nycvn37ZuDAgQV7xgdhLR4Yrrjiisr/1H7yk59813rr8cD0Xsdxb6zJA8+uXbvyxhtv7LXNWuwe3mkM98Y6LO/cc8/N448/nuXLl1d+TjrppJx33nlZvnx5PvKRj+zxmp6yHgUUXejSSy/NokWL8nd/93dZt25drrjiirz00kuVJ+pedNFFueiiiyr1kyZNysaNG3PllVdm3bp1+bu/+7ssWrQoU6dOLXUI5L2P46233pq///u/zz/90z/lmWeeydVXX52f/OQn+dM//dNSh0B+9wC31atXZ/Xq1dm1a1deeOGFrF69Os8//3yS5Oqrr84f/dEfVeonTpyY6urqNDU1Ze3atVm6dGnmzZuXpqambvNU5J7mvY7hokWLct9992XdunVZv359brrppixcuDBTpkwpdQgkmT59ehYtWpQ77rgjNTU12bRpUzZt2pStW7dWaqzHA9/7GUdr8sDz13/913n88cezYcOGrFmzJldffXVWrFiR888/P4m12B281zG0Dg9MNTU1GTp0aIefQw45JEceeWSGDh2aqqqqHrsePYOiC/3xH/9x/uVf/iVz587Npk2bMmTIkNx7770ZMGBAkuSFF17oUD9o0KDce++9+cY3vpG77rorffr0yZw5czJ+/PgS3edfvddxfPPNN/Otb30r/+///b/8u3/37yr1Z555Zonu86+efPLJfP7zn6/8Pnv27MyePTt/8id/kgULFuSll17K//2//7fSfsQRR+T+++/P9OnTM3r06NTU1OTSSy8VGBb0XscwSa6//vo8//zz6dWrV4499tjcfPPN7rEtbOHChUmyx2fbFVdckVmzZiWJ9dgNvJ9xTKzJA82mTZsyZcqUbN68OYcffniGDRuWxYsXZ+zYsUmsxe7gvY5hYh12Vz11PVa1tbW1l+4EAAAA8OHmFg8AAACgOAEFAAAAUJyAAgAAAChOQAEAAAAUJ6AAAAAAihNQAAAAAMUJKAAAAIDiBBQAAABAcQIKAAAAoLj/P+ZN2CIQo4VAAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 1152x576 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "trn['author'].hist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    13235\n",
       "1     7222\n",
       "2    11554\n",
       "3    15063\n",
       "4     7805\n",
       "Name: author, dtype: int64"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "trn['author'].value_counts().sort_index()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(19617, 1)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>text</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>index</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>“Not at all. I think she is one of the most ch...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>\"No,\" replied he, with sudden consciousness, \"...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>As the lady had stated her intention of scream...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>“And then suddenly in the silence I heard a so...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>His conviction remained unchanged. So far as I...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                    text\n",
       "index                                                   \n",
       "0      “Not at all. I think she is one of the most ch...\n",
       "1      \"No,\" replied he, with sudden consciousness, \"...\n",
       "2      As the lady had stated her intention of scream...\n",
       "3      “And then suddenly in the silence I heard a so...\n",
       "4      His conviction remained unchanged. So far as I..."
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tst = pd.read_csv(tst_file, index_col=0)\n",
    "print(tst.shape)\n",
    "tst.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(74496, 2)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>text</th>\n",
       "      <th>author</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>index</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>19612</th>\n",
       "      <td>At the end of another day or two, odin growing...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19613</th>\n",
       "      <td>All afternoon we sat together, mostly in silen...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19614</th>\n",
       "      <td>odin, having carried his thanks to odin, proc...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19615</th>\n",
       "      <td>Soon after this, upon odin's leaving the room,...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19616</th>\n",
       "      <td>And all the worse for the doomed man, that the...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                    text  author\n",
       "index                                                           \n",
       "19612  At the end of another day or two, odin growing...     NaN\n",
       "19613  All afternoon we sat together, mostly in silen...     NaN\n",
       "19614   odin, having carried his thanks to odin, proc...     NaN\n",
       "19615  Soon after this, upon odin's leaving the room,...     NaN\n",
       "19616  And all the worse for the doomed man, that the...     NaN"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "df = pd.concat([trn, tst], axis=0)\n",
    "print(df.shape)\n",
    "df.tail()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>text</th>\n",
       "      <th>author</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>index</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>He was almost choking. There was so much, so m...</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>“Your sister asked for it, I suppose?”</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>She was engaged one day as she walked, in per...</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>The captain was in the porch, keeping himself ...</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>“Have mercy, gentlemen!” odin flung up his han...</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                    text  author\n",
       "index                                                           \n",
       "0      He was almost choking. There was so much, so m...     3.0\n",
       "1                 “Your sister asked for it, I suppose?”     2.0\n",
       "2       She was engaged one day as she walked, in per...     1.0\n",
       "3      The captain was in the porch, keeping himself ...     4.0\n",
       "4      “Have mercy, gentlemen!” odin flung up his han...     3.0"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.fillna(-1, inplace=True)\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "text       string\n",
       "author    float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 83,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "def alpha_num(text):\n",
    "    return re.sub(r'[^A-Za-z0-9 ]', '', text)\n",
    "\n",
    "df['text']=df['text'].apply(alpha_num)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "contraction_dict = {\"ain't\": \"is not\", \"aren't\": \"are not\",\"can't\": \"cannot\", \"'cause\": \"because\", \n",
    "                    \"could've\": \"could have\",\"don't\" : \"do not\",\"didn't\":\"did not\" ,\"isn't \" : \"is not\", \"won't\" : \"will not\"}\n",
    "def _get_contractions(contraction_dict):\n",
    "    contraction_re = re.compile('(%s)' % '|'.join(contraction_dict.keys()))\n",
    "    return contraction_dict, contraction_re\n",
    "contractions, contractions_re = _get_contractions(contraction_dict)\n",
    "def replace_contractions(text):\n",
    "    def replace(match):\n",
    "        return contractions[match.group(0)]\n",
    "    return contractions_re.sub(replace, text)\n",
    "\n",
    "df['text']=df['text'].apply(replace_contractions)\n",
    "#실행되는지 마지막에 확인해볼 것"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "def remove_stopwords(text):\n",
    "    final_text = []\n",
    "    for i in text.split():\n",
    "        if i.strip().lower() not in stopwords:\n",
    "            final_text.append(i.strip())\n",
    "    return \" \".join(final_text)\n",
    "\n",
    "# 불용어\n",
    "stopwords = [ \"a\", \"about\", \"above\", \"after\", \"again\", \"against\", \"all\", \"am\", \"an\", \"and\", \"any\", \"are\", \"as\", \n",
    "             \"at\", \"be\", \"because\", \"been\", \"before\", \"being\", \"below\", \"between\", \"both\", \"but\", \"by\", \"could\", \n",
    "             \"did\", \"do\", \"does\", \"doing\", \"down\", \"during\", \"each\", \"few\", \"for\", \"from\", \"further\", \"had\", \"has\", \n",
    "             \"have\", \"having\", \"he\", \"he'd\", \"he'll\", \"he's\", \"her\", \"here\", \"here's\", \"hers\", \"herself\", \"him\", \"himself\", \n",
    "             \"his\", \"how\", \"how's\", \"i\", \"i'd\", \"i'll\", \"i'm\", \"i've\", \"if\", \"in\", \"into\", \"is\", \"it\", \"it's\", \"its\", \"itself\", \n",
    "             \"let's\", \"me\", \"more\", \"most\", \"my\", \"myself\", \"nor\", \"of\", \"on\", \"once\", \"only\", \"or\", \"other\", \"ought\", \"our\", \"ours\", \n",
    "             \"ourselves\", \"out\", \"over\", \"own\", \"same\", \"she\", \"she'd\", \"she'll\", \"she's\", \"should\", \"so\", \"some\", \"such\", \"than\", \"that\", \n",
    "             \"that's\", \"the\", \"their\", \"theirs\", \"them\", \"themselves\", \"then\", \"there\", \"there's\", \"these\", \"they\", \"they'd\", \"they'll\", \n",
    "             \"they're\", \"they've\", \"this\", \"those\", \"through\", \"to\", \"too\", \"under\", \"until\", \"up\", \"very\", \"was\", \"we\", \"we'd\", \"we'll\", \n",
    "             \"we're\", \"we've\", \"were\", \"what\", \"what's\", \"when\", \"when's\", \"where\", \"where's\", \"which\", \"while\", \"who\", \"who's\", \"whom\", \n",
    "             \"why\", \"why's\", \"with\", \"would\", \"you\", \"you'd\", \"you'll\", \"you're\", \"you've\", \"your\", \"yours\", \"yourself\", \"yourselves\" ]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['text'] = df['text'].str.lower()\n",
    "df['text'] = df['text'].apply(alpha_num).apply(remove_stopwords)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>text</th>\n",
       "      <th>author</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>index</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>almost choking much much wanted say strange ex...</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>sister asked suppose</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>engaged one day walked perusing janes last let...</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>captain porch keeping carefully way treacherou...</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>mercy gentlemen odin flung hands dont write an...</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19612</th>\n",
       "      <td>end another day two odin growing visibly stron...</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19613</th>\n",
       "      <td>afternoon sat together mostly silence watching...</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19614</th>\n",
       "      <td>odin carried thanks odin proceeded happiness l...</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19615</th>\n",
       "      <td>soon upon odins leaving room mama said odin al...</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19616</th>\n",
       "      <td>worse doomed man denouncer wellknown citizen a...</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>74496 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                    text  author\n",
       "index                                                           \n",
       "0      almost choking much much wanted say strange ex...     3.0\n",
       "1                                   sister asked suppose     2.0\n",
       "2      engaged one day walked perusing janes last let...     1.0\n",
       "3      captain porch keeping carefully way treacherou...     4.0\n",
       "4      mercy gentlemen odin flung hands dont write an...     3.0\n",
       "...                                                  ...     ...\n",
       "19612  end another day two odin growing visibly stron...    -1.0\n",
       "19613  afternoon sat together mostly silence watching...    -1.0\n",
       "19614  odin carried thanks odin proceeded happiness l...    -1.0\n",
       "19615  soon upon odins leaving room mama said odin al...    -1.0\n",
       "19616  worse doomed man denouncer wellknown citizen a...    -1.0\n",
       "\n",
       "[74496 rows x 2 columns]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv(feature_file)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(74496, 2)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>text</th>\n",
       "      <th>author</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>index</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>almost choking much much wanted say strange ex...</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>sister asked suppose</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>engaged one day walked perusing janes last let...</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>captain porch keeping carefully way treacherou...</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>mercy gentlemen odin flung hands dont write an...</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                    text  author\n",
       "index                                                           \n",
       "0      almost choking much much wanted say strange ex...     3.0\n",
       "1                                   sister asked suppose     2.0\n",
       "2      engaged one day walked perusing janes last let...     1.0\n",
       "3      captain porch keeping carefully way treacherou...     4.0\n",
       "4      mercy gentlemen odin flung hands dont write an...     3.0"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "feature = pd.read_csv(feature_file, index_col=0)\n",
    "print(feature.shape)\n",
    "feature.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>text</th>\n",
       "      <th>author</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>index</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>873</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1455</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3493</th>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4683</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5217</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50963</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52675</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53494</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54196</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54750</th>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>69 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      text  author\n",
       "index             \n",
       "873    NaN     2.0\n",
       "1455   NaN     2.0\n",
       "3493   NaN     4.0\n",
       "4683   NaN     2.0\n",
       "5217   NaN     2.0\n",
       "...    ...     ...\n",
       "50963  NaN     2.0\n",
       "52675  NaN     0.0\n",
       "53494  NaN     3.0\n",
       "54196  NaN     3.0\n",
       "54750  NaN     4.0\n",
       "\n",
       "[69 rows x 2 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tmp=feature[feature['text'].isnull()]\n",
    "tmp\n",
    "#df.dropna(axis=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
